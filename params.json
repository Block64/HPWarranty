{"name":"HPWarranty","tagline":"PowerShell module to help retrieve Hewlett-Packard Warranty Information","body":"# HPWarranty PowerShell Module\r\n\r\nThis module can be installed with [chocolatey](https://chocolatey.org/packages/hpwarranty.powershell):\r\n```PowerShell\r\nchoco install hpwarranty.powershell -version 0.0.2.4\r\n```\r\n\r\nThis module can be installed with [PsGet](http://psget.net/):\r\n```PowerShell\r\nInstall-Module -ModuleUrl \"https://github.com/dotps1/HPWarranty/raw/master/HPWarranty.zip\" -ModuleName HPWarranty -Type ZIP\r\n```\r\n\r\n## HPWarranty Cmdlets\r\n\r\n* [Invoke-HPWarrantyRegistrationRequest](https://github.com/dotps1/HPWarranty/wiki/Invoke-HPWarrantyRegistrationRequest)\r\n* [Invoke-HPWarrantyEntitlementList](https://github.com/dotps1/HPWarranty/wiki/Invoke-HPWarrantyEntitlementList)\r\n* [Get-HPComputerInformationForWarrantyFromCMDB](https://github.com/dotps1/HPWarranty/wiki/Get-HPComputerInformationForWarrantyFromCMDB)\r\n\r\nBasically, to use HPs ISEE to get warranty info, there are a few things that need to happen:\r\n\r\n1.  A Session needs to be established with their Web Services, this is done by using the Invoke-HPWarrantyRegistrationRequest.  You need a valid SerialNumber and Product Model to do this.  If successful, it will return a Gdid and a Session Token, that then needs to be passed to the Invoke-HPWarrantyEntitlementList.\r\n2.  Using the Gdid and the Token from step 1, and a valid SerialNumber and ProductNumber you can request the information for that device, returning the SerialNumber,ProductID,ActiveWarrantyEntitlement,OverallWarrantyStartDate,OverallWarrantyEndDate,WarrantyDeterminationDescription,GracePeriod (The return SOAP Envelop contains much more information, but that is was I parse and return).\r\n3.  You can reuse the Gdid and Token from step one in a foreach loop to retrieve multiple warranty objects.  That is why I created the Get-HPComputerInformationForWarrantyRequestFromCMDB (only tested on SCCM 2012 SP1 DB).  If you configure your SCCM Client to inventory the MS_SystemInformation WMI Class (Found in the root namespace, not in CIMV2, root\\MS_SystemInformation) you can then use this function to return form the CM_<SiteCode> database an array of objects containing the information needed to complete all actions.  SerialNumber,ProductModel,ProductID.\r\n\r\n\r\nExample 1:\r\n```PowerShell\r\n# Execute from a local HP Workstation\r\nImport-Module HPWarranty; Invoke-HPWarrantyEntitlementList\r\n```\r\n\r\nExample 2:\r\n```PowerShell\r\n# Create one session but look up multiple warranty's\r\nImport-Module -Name HPWarranty\r\n\r\n$HP1 = @{\r\n\t'SerialNumber' = 'A1B2C3D4E5'\r\n\t'ProductModel' = 'HP Laptop 100 G1'\r\n\t'ProductID' = '123ABC'\r\n}\r\n\r\n$HP2 = @{\r\n\t'SerialNumber' = '12345ABCDE'\r\n\t'ProductModel' = 'HP Desktop 1100 G1'\r\n\t'ProductID' = 'ABC123'\r\n}\r\n\r\n\t\r\n# Use either HP1 or HP2 properties to establish a session with the HP Web Services.\r\n$reg = Invoke-HPWarrantyRegistrationRequest -SerialNumber $HP1.SerialNumber -ProductModel $HP1.ProductModel\r\n\r\nInvoke-HPWarrantyEntitlementList -Gdid $reg.Gdid -Token $reg.Token -SerialNumber $HP1.SerialNumber -ProductID $HP1.ProductID\r\nInvoke-HPWarrantyEntitlementList -Gdid $reg.Gdid -Token $reg.Token -SerialNumber $HP2.SerialNumber -ProductID $HP2.ProductID\r\n```\r\n\r\nExample 3:\r\n```PowerShell\r\n# Query a remote computer for information to create a session with the the HP Web Services.\r\n# Remote WMI access is necessary to use this function remotely.\r\nImport-Module -Name HPWarranty; Invoke-HPWarrantyEntitlementList -ComputerName 'HPComputer.mydomain.org'\r\n```\r\n\r\nExample 4:\r\n```PowerShell\r\n# Execute with information from ConfigMgr Database:\r\nImport-Module -Name HPWarranty\r\n\r\n$reg = Invoke-HPWarrantyRegistrationRequest -SerialNumber \"ABCDE12345\" -ProductModel \"HP ProBook 645 G1\"\r\n\r\n$HPs = Get-HPComputerInformationForWarrantyFromCMDB -SqlServer MySccmDBServer -Database CM_MS1 -IntergratedSecurity\r\nforeach ($HP in $HPs)\r\n{\r\n\t Invoke-HPWarrantyEntitlementList -Gdid $reg.Gdid -Token $reg.Token -SerialNumber $HP.SerialNumber -ProductID $HP.ProductID\r\n}\r\n```\r\n\t\r\nExample 5:\r\n```PowerShell\r\n# Hashtables are a little tricky to export to CSV, so here is how I run my build date report:\r\nImport-Module -Name HPWarranty\r\nImport-Module -Name ActiveDirectory\r\n\r\n$reg = Invoke-HPWarrantyRegistrationRequest\r\n\r\n# This output is tailored to the request that was given to me, not all of these values maybe necessary to return.\r\nGet-HPComputerInformationForWarrantyFromCMDB -SqlServer MyCMDB.mydomain.org -Database CM_MS1 -IntergratedSecurity |\r\nSelect-Object -Property @{ Name = 'ComputerName';     Expression = { $_.ComputerName } }, \r\n\t\t\t\t\t\t@{ Name = 'SerialNumber';     Expression = { $_.SerialNumber } }, \r\n\t\t\t\t\t\t@{ Name = 'ProductModel';     Expression = { $_.ProductModel } }, \r\n\t\t\t\t\t\t@{ Name = 'BuildDate';        Expression = { (Invoke-HPWarrantyEntitlementList -Gdid $reg.Gdid -Token $reg.Token -SerialNumber $_.SerialNumber -ProductID $_.ProductID).OverallWarrantyStartDate } },\r\n\t\t\t\t\t\t@{ Name = 'LastHardwareScan'; Expression = { Get-Date (Get-Date $_.LastHardwareScan).ToShortDateString() -Format 'yyyy-MM-dd' } },\r\n\t\t\t\t\t\t@{ Name = 'LastLoggedOnUser'; Expression = { $_.Username } },\r\n\t\t\t\t\t\t@{ Name = 'CompanyName';      Expression = { if ($_.Username -ne $null){ (Get-ADUser -Identity $_.Username.ToString().Trim('MYDOMAIN\\') -Properties Company).Company } } } |\r\nExport-Csv -Path C:\\HPBuildInfo.csv -NoTypeInformation -Append \r\n```","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}